<wxs module="filter" src="/utils/numberToFixed.wxs"></wxs>
<!-- 搜索框 -->
<!-- <mp-searchbar bindclear="clear" ext-class="searchResult" bindselectresult="selectResult" throttle="1000" search="{{search}}"></mp-searchbar> -->
<!-- 榜单 -->
<!-- <view class="bd">
  <view class="confirm bubble">
    <view class="bd_image_box">
      <image src="/static/image/imaIu.png"></image>
    </view>
    <view class="bd_text">销量榜</view>
  </view>
  <view class="confirm bubble">
    <view class="bd_image_box">
      <image src="/static/image/imaIu.png"></image>
    </view>
    <view class="bd_text">评价榜</view>
  </view>
  <view class="confirm bubble">
    <view class="bd_image_box">
      <image src="/static/image/imaIu.png"></image>
    </view>
    <view class="bd_text">本地特产</view>
  </view>
  <view class="confirm bubble">
    <view class="bd_image_box">
      <image src="/static/image/imaIu.png"></image>
    </view>
    <view class="bd_text">佳节好礼</view>
  </view>
</view> -->

<!-- 内容 -->
<scroll-view scroll-y="true" style="height: 85%;" lower-threshold='50' bindscrolltolower="searchScrollLower">
  <view class='list'>
    <checkbox-group bindchange="">
      <block wx:for='{{dataList}}' wx:key='index' wx:for-item="item">
        <view class="list_item" catchtap="onListbtn" data-item="{{item}}">
          <view class='img'>
            <image src="{{imghref}}{{item.simg}}" mode="aspectFit" />
          </view>

          <view class='info'>
            <view class='title'>{{item.title}}</view>
            <!-- 商品辅加信息 -->
            <view class="product_add">
              <view>{{item.scorenum}}+评分</view>
              <view>{{item.views}}+浏览</view>
              <view>{{item.salenum}}+销售</view>
              <view>{{item.share}}+分享</view>
            </view>
            <!-- 是否包分配 -->
            <!-- <view class="product_isfenpei">
              <view class="isdelivery" wx:if="{{item.isdelivery}}">包分配</view>
              <view class="issorting" wx:if="{{item.issorting}}">包分拣</view>
            </view> -->
            <view wx:if="{{item.openingPrice}}"><text style="font-size: 30rpx;">赚</text><text style="color: #f71313;">￥<text style="font-size: 40rpx;">{{item.incomePrice}}</text></text></view>
            <!-- 商品底部 -->
            <view class="product_footer">
              <view class='price'>供应价:<text style="color: rgb(254, 89, 9);">￥{{item.supplyprice}}</text></view>
              <view class="delete" catchtap="stop">
                <!-- <checkbox checked="{{item.isCheckShow}}" bindtap="selectList" data-data="{{item}}" value="{{item.id}}" /> -->
                <button size="mini" style="font-size: 19rpx;" data-item="{{item}}" bindtap="setPrice">设置价格</button>
              </view>
            </view>
            <!-- <view class='num'>销量{{item.salenum}}</view> -->
          </view>
          <view class='clear'></view>
        </view>
      </block>
    </checkbox-group>
  </view>
</scroll-view>

<!-- 分享 -->
<view class="shareBtn" wx:if="{{isShare}}">
  <button bindtap="onShare" type="primary">分享</button>
</view>

<!--商品详情-->
<mp-half-screen-dialog extClass="mp-half-screen-dialog" bindbuttontap="buttontap" show="{{show}}" maskClosable="{{false}}" title="商品详情" subTitle="" buttons="{{buttons}}">
  <view slot="desc">
    <view wx:if="{{isnavShow}}" style="{{isnavShow?'animation:show 1s':''}}" class="swiper-tab">
      <view class="tab-item {{currentTab==0 ? 'on' : ''}}" data-current="0" bindtap="swichNav">商品</view>
      <view class="tab-item {{currentTab==1 ? 'on' : ''}}" data-current="1" bindtap="swichNav">评价</view>
      <view class="tab-item {{currentTab==2 ? 'on' : ''}}" data-current="2" bindtap="swichNav">详情</view>
    </view>
    <scroll-view bindscroll="scrollViewScroll" style="height:53vh;" scroll-y="true" scroll-into-view="{{toView}}">
      <view id="toView0" class="continue">
        <view class="greyBox">
          <swiper indicator-dots current="0" style="height:560rpx">
            <swiper-item wx:if="{{productInfo.dvideo}}">

              <video show-mute-btn play-btn-position="center" style="width: 100%;height: 100%;" autoplay show-fullscreen-btn show-bottom-progress src="{{href}}{{productInfo.dvideo}}"></video>
            </swiper-item>
            <swiper-item wx:for="{{productInfo.dimgslist}}" wx:key="index" style="text-align: center;">
              <image src="{{href}}{{item}}" style="height:100%;" mode="heightFix"></image>
            </swiper-item>
          </swiper>
          <view class="bottom_box">
            <view class="price_box">
              <view style="display: flex;">
                <view style="font-size: 12px;color: var(--IgnoreMessage);">供应价
                  <text style="color: #f79213;">￥<text style="font-size: 35rpx;">{{filter.numberToFixed(productInfo.supplyprice)}}</text></text>
                </view>
                <view style="margin-left: 30rpx;font-size: 12px;color: var(--IgnoreMessage);">建议价<text style="color: #f79213;">￥<text style="font-size: 35rpx;">{{productInfo.recommendedprice}}</text></text></view>
                <view></view>
              </view>
              <view class="sale_box">
                销量: 0 件
              </view>
            </view>

            <view style="margin-top: 10rpx;">
              <text style="font-size: 14px;font-weight: 600;">{{productInfo.title}}</text>
            </view>
          </view>
        </view>
        <!-- 评价 -->
        <view id="toView1" class="appraise">
          <view class="appraise_header">
            <view>宝贝评价({{productInfo.scorenum}})</view>
            <view bindtap="viewCount">查看全部 ></view>
          </view>
        </view>
        <!-- 详情 -->
        <view id="toView2" class="appraise">
          <view class="appraise_header">
            <view>商品详情</view>
          </view>
          <view style="font-size: 25rpx;margin-top: 10rpx;">
            {{productInfo.details}}
          </view>
          <!-- 商品图片 -->
          <view style="text-align: center;margin-top: 10rpx;">
            <block wx:for="{{productInfo.dimgslist}}" wx:key="index">
              <image src="{{href}}{{item}}" style="width: 100%;" mode="widthFix"></image>
            </block>
          </view>
        </view>
      </view>
    </scroll-view>


  </view>
</mp-half-screen-dialog>

<!-- 分享表单 -->
<mp-half-screen-dialog bindclose="onShareClose" extClass="mp-half-screen-dialog" bindbuttontap="sharebuttontap" show="{{isShareFormShow}}" maskClosable="{{false}}" title="商品分享" subTitle="填写商品地址">
  <view slot="desc">
    <mp-toptips msg="{{error}}" type="error" show="{{error}}"></mp-toptips>
    <view class="page">
      <view class="page__bd">
        <mp-cells title="" footer="">
          <mp-cell show-error prop="deadline" title="截单时间" ext-class="bbb">
            <picker slot="footer" data-field="deadline" mode="time" value="{{date}}" start="00:00" end="21:00" bindchange="bindDateChange">
              <view class="weui-input">{{date}}</view>
            </picker>
          </mp-cell>
          <mp-cell ext-class="bbb" show-error prop="deliveryAddress">
            <view slot="title">交货地址</view>
            <view slot="footer" style="width:300rpx">
              <input model:value="{{deliveryaddress}}" data-field="deliveryAddress" class="weui-input" placeholder="请输入交货地址" />
            </view>
          </mp-cell>
        </mp-cells>
      </view>
    </view>
  </view>
  <view slot="footer">
    <button bindtap="falseShare" wx:if="{{filter.stringTrim( deliveryaddress) == ''}}" type="primary">分享</button>
    <button wx:else open-type="share" type="primary">分享</button>
  </view>
</mp-half-screen-dialog>